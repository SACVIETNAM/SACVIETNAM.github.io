var Ot=Object.defineProperty;var St=(s,t,e)=>t in s?Ot(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var dt=(s,t,e)=>(St(s,typeof t!="symbol"?t+"":t,e),e),G=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var r=(s,t,e)=>(G(s,t,"read from private field"),e?e.call(s):t.get(s)),o=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},c=(s,t,e,i)=>(G(s,t,"write to private field"),i?i.call(s,e):t.set(s,e),e);var d=(s,t,e)=>(G(s,t,"access private method"),e);import{b_ as wt,b$ as X,c0 as Tt,c1 as ft,c2 as pt,c3 as Ut,c4 as Qt,c5 as kt,c6 as bt,c7 as mt,r as m,c8 as Dt,aw as gt}from"./index-51183d7f.js";import{c as Ft,b as xt,d as Lt}from"./authService-57dbc50f.js";var b,a,P,p,O,Q,y,M,k,D,S,w,E,F,T,x,A,Y,B,Z,W,q,$,tt,j,et,J,st,_,rt,z,Ct,Rt,Pt=(Rt=class extends wt{constructor(t,e){super();o(this,T);o(this,A);o(this,B);o(this,W);o(this,$);o(this,j);o(this,J);o(this,_);o(this,z);o(this,b,void 0);o(this,a,void 0);o(this,P,void 0);o(this,p,void 0);o(this,O,void 0);o(this,Q,void 0);o(this,y,void 0);o(this,M,void 0);o(this,k,void 0);o(this,D,void 0);o(this,S,void 0);o(this,w,void 0);o(this,E,void 0);o(this,F,new Set);this.options=e,c(this,b,t),c(this,y,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,a).addObserver(this),vt(r(this,a),this.options)?d(this,T,x).call(this):this.updateResult(),d(this,$,tt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return it(r(this,a),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return it(r(this,a),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,j,et).call(this),d(this,J,st).call(this),r(this,a).removeObserver(this)}setOptions(t,e){const i=this.options,u=r(this,a);if(this.options=r(this,b).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");d(this,_,rt).call(this),r(this,a).setOptions(this.options),i._defaulted&&!X(this.options,i)&&r(this,b).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,a),observer:this});const n=this.hasListeners();n&&yt(r(this,a),u,this.options,i)&&d(this,T,x).call(this),this.updateResult(e),n&&(r(this,a)!==u||this.options.enabled!==i.enabled||this.options.staleTime!==i.staleTime)&&d(this,A,Y).call(this);const h=d(this,B,Z).call(this);n&&(r(this,a)!==u||this.options.enabled!==i.enabled||h!==r(this,E))&&d(this,W,q).call(this,h)}getOptimisticResult(t){const e=r(this,b).getQueryCache().build(r(this,b),t),i=this.createResult(e,t);return At(this,i)&&(c(this,p,i),c(this,Q,this.options),c(this,O,r(this,a).state)),i}getCurrentResult(){return r(this,p)}trackResult(t,e){const i={};return Object.keys(t).forEach(u=>{Object.defineProperty(i,u,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(u),e==null||e(u),t[u])})}),i}trackProp(t){r(this,F).add(t)}getCurrentQuery(){return r(this,a)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=r(this,b).defaultQueryOptions(t),i=r(this,b).getQueryCache().build(r(this,b),e);return i.isFetchingOptimistic=!0,i.fetch().then(()=>this.createResult(i,e))}fetch(t){return d(this,T,x).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,p)))}createResult(t,e){var lt;const i=r(this,a),u=this.options,n=r(this,p),h=r(this,O),f=r(this,Q),U=t!==i?t.state:r(this,P),{state:C}=t;let l={...C},at=!1,v;if(e._optimisticResults){const g=this.hasListeners(),K=!g&&vt(t,e),It=g&&yt(t,i,e,u);(K||It)&&(l={...l,...kt(C.data,t.options)}),e._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:ot,errorUpdatedAt:ht,status:I}=l;if(e.select&&l.data!==void 0)if(n&&l.data===(h==null?void 0:h.data)&&e.select===r(this,M))v=r(this,k);else try{c(this,M,e.select),v=e.select(l.data),v=bt(n==null?void 0:n.data,v,e),c(this,k,v),c(this,y,null)}catch(g){c(this,y,g)}else v=l.data;if(e.placeholderData!==void 0&&v===void 0&&I==="pending"){let g;if(n!=null&&n.isPlaceholderData&&e.placeholderData===(f==null?void 0:f.placeholderData))g=n.data;else if(g=typeof e.placeholderData=="function"?e.placeholderData((lt=r(this,D))==null?void 0:lt.state.data,r(this,D)):e.placeholderData,e.select&&g!==void 0)try{g=e.select(g),c(this,y,null)}catch(K){c(this,y,K)}g!==void 0&&(I="success",v=bt(n==null?void 0:n.data,g,e),at=!0)}r(this,y)&&(ot=r(this,y),v=r(this,k),ht=Date.now(),I="error");const H=l.fetchStatus==="fetching",N=I==="pending",V=I==="error",ct=N&&H,ut=v!==void 0;return{status:I,fetchStatus:l.fetchStatus,isPending:N,isSuccess:I==="success",isError:V,isInitialLoading:ct,isLoading:ct,data:v,dataUpdatedAt:l.dataUpdatedAt,error:ot,errorUpdatedAt:ht,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>U.dataUpdateCount||l.errorUpdateCount>U.errorUpdateCount,isFetching:H,isRefetching:H&&!N,isLoadingError:V&&!ut,isPaused:l.fetchStatus==="paused",isPlaceholderData:at,isRefetchError:V&&ut,isStale:nt(t,e),refetch:this.refetch}}updateResult(t){const e=r(this,p),i=this.createResult(r(this,a),this.options);if(c(this,O,r(this,a).state),c(this,Q,this.options),r(this,O).data!==void 0&&c(this,D,r(this,a)),X(i,e))return;c(this,p,i);const u={},n=()=>{if(!e)return!0;const{notifyOnChangeProps:h}=this.options,f=typeof h=="function"?h():h;if(f==="all"||!f&&!r(this,F).size)return!0;const R=new Set(f??r(this,F));return this.options.throwOnError&&R.add("error"),Object.keys(r(this,p)).some(U=>{const C=U;return r(this,p)[C]!==e[C]&&R.has(C)})};(t==null?void 0:t.listeners)!==!1&&n()&&(u.listeners=!0),d(this,z,Ct).call(this,{...u,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,$,tt).call(this)}},b=new WeakMap,a=new WeakMap,P=new WeakMap,p=new WeakMap,O=new WeakMap,Q=new WeakMap,y=new WeakMap,M=new WeakMap,k=new WeakMap,D=new WeakMap,S=new WeakMap,w=new WeakMap,E=new WeakMap,F=new WeakMap,T=new WeakSet,x=function(t){d(this,_,rt).call(this);let e=r(this,a).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(Tt)),e},A=new WeakSet,Y=function(){if(d(this,j,et).call(this),ft||r(this,p).isStale||!pt(this.options.staleTime))return;const e=Ut(r(this,p).dataUpdatedAt,this.options.staleTime)+1;c(this,S,setTimeout(()=>{r(this,p).isStale||this.updateResult()},e))},B=new WeakSet,Z=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,a)):this.options.refetchInterval)??!1},W=new WeakSet,q=function(t){d(this,J,st).call(this),c(this,E,t),!(ft||this.options.enabled===!1||!pt(r(this,E))||r(this,E)===0)&&c(this,w,setInterval(()=>{(this.options.refetchIntervalInBackground||Qt.isFocused())&&d(this,T,x).call(this)},r(this,E)))},$=new WeakSet,tt=function(){d(this,A,Y).call(this),d(this,W,q).call(this,d(this,B,Z).call(this))},j=new WeakSet,et=function(){r(this,S)&&(clearTimeout(r(this,S)),c(this,S,void 0))},J=new WeakSet,st=function(){r(this,w)&&(clearInterval(r(this,w)),c(this,w,void 0))},_=new WeakSet,rt=function(){const t=r(this,b).getQueryCache().build(r(this,b),this.options);if(t===r(this,a))return;const e=r(this,a);c(this,a,t),c(this,P,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},z=new WeakSet,Ct=function(t){mt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(r(this,p))}),r(this,b).getQueryCache().notify({query:r(this,a),type:"observerResultsUpdated"})})},Rt);function Mt(s,t){return t.enabled!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&t.retryOnMount===!1)}function vt(s,t){return Mt(s,t)||s.state.data!==void 0&&it(s,t,t.refetchOnMount)}function it(s,t,e){if(t.enabled!==!1){const i=typeof e=="function"?e(s):e;return i==="always"||i!==!1&&nt(s,t)}return!1}function yt(s,t,e,i){return(s!==t||i.enabled===!1)&&(!e.suspense||s.state.status!=="error")&&nt(s,e)}function nt(s,t){return t.enabled!==!1&&s.isStaleByTime(t.staleTime)}function At(s,t){return!X(s.getCurrentResult(),t)}var Et=m.createContext(!1),Bt=()=>m.useContext(Et);Et.Provider;function Wt(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var $t=m.createContext(Wt()),jt=()=>m.useContext($t);function Jt(s,t){return typeof s=="function"?s(...t):!!s}var _t=(s,t)=>{(s.suspense||s.throwOnError)&&(t.isReset()||(s.retryOnMount=!1))},zt=s=>{m.useEffect(()=>{s.clearReset()},[s])},Ht=({result:s,errorResetBoundary:t,throwOnError:e,query:i})=>s.isError&&!t.isReset()&&!s.isFetching&&i&&Jt(e,[s.error,i]),Nt=s=>{s.suspense&&typeof s.staleTime!="number"&&(s.staleTime=1e3)},Vt=(s,t)=>(s==null?void 0:s.suspense)&&t.isPending,Kt=(s,t,e)=>t.fetchOptimistic(s).catch(()=>{e.clearReset()});function Gt(s,t,e){const i=Dt(e),u=Bt(),n=jt(),h=i.defaultQueryOptions(s);h._optimisticResults=u?"isRestoring":"optimistic",Nt(h),_t(h,n),zt(n);const[f]=m.useState(()=>new t(i,h)),R=f.getOptimisticResult(h);if(m.useSyncExternalStore(m.useCallback(U=>{const C=u?()=>{}:f.subscribe(mt.batchCalls(U));return f.updateResult(),C},[f,u]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),m.useEffect(()=>{f.setOptions(h,{listeners:!1})},[h,f]),Vt(h,R))throw Kt(h,f,n);if(Ht({result:R,errorResetBoundary:n,throwOnError:h.throwOnError,query:i.getQueryCache().get(h.queryHash)}))throw R.error;return h.notifyOnChangeProps?R:f.trackResult(R)}function ie(s,t){return Gt(s,Pt,t)}class L extends Error{}L.prototype.name="InvalidTokenError";function Xt(s){return decodeURIComponent(atob(s).replace(/(.)/g,(t,e)=>{let i=e.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}function Yt(s){let t=s.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Xt(t)}catch{return atob(t)}}function Zt(s,t){if(typeof s!="string")throw new L("Invalid token specified: must be a string");t||(t={});const e=t.header===!0?0:1,i=s.split(".")[e];if(typeof i!="string")throw new L(`Invalid token specified: missing part #${e+1}`);let u;try{u=Yt(i)}catch(n){throw new L(`Invalid token specified: invalid base64 for part #${e+1} (${n.message})`)}try{return JSON.parse(u)}catch(n){throw new L(`Invalid token specified: invalid json for part #${e+1} (${n.message})`)}}class qt{static getJWTInstance(){return this.JWTInstance||(this.JWTInstance=Ft.create({baseURL:xt,headers:{"Content-Type":"application/json"},withCredentials:!0}),this.JWTInstance.interceptors.request.use(async t=>{const e=gt.getItem("USER"),i=e==null?void 0:e.accessToken;if(!i)return t;if(Zt(i).exp<new Date().getTime()/1e3){const n=await Lt();gt.setItem("USER",{...e,accessToken:n}),console.log("REFRESHED TOKEN",n),t.headers.authorization=`Bearer ${n}`}else t.headers.authorization=`Bearer ${i}`;return t})),this.JWTInstance}}dt(qt,"JWTInstance",null);export{qt as A,ie as u};

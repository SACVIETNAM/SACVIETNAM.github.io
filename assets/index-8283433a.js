import{a3 as q,r as o,a7 as T,aU as H,Z as w,aS as A,aV as Y,aW as E,aA as k,aX as G,aY as U,aZ as D,ai as M,P as Z,a8 as J,L as I,j as a,au as K,aD as S,J as Q,aw as ee,aC as $,m as te,a_ as ne}from"./index-a11c9a5b.js";import{F as y}from"./Formatter-fb77eadb.js";import{D as ae}from"./DeleteOutlined-41f710a8.js";import{E as se}from"./index-44d99f72.js";import{D as le}from"./index-94cb970d.js";const oe=e=>{const{componentCls:n,iconCls:s,antCls:t,zIndexPopup:l,colorText:u,colorWarning:m,marginXXS:c,marginXS:r,fontSize:p,fontWeightStrong:v,colorTextHeading:g}=e;return{[n]:{zIndex:l,[`&${t}-popover`]:{fontSize:p},[`${n}-message`]:{marginBottom:r,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${n}-message-icon ${s}`]:{color:m,fontSize:p,lineHeight:1,marginInlineEnd:r},[`${n}-title`]:{fontWeight:v,color:g,"&:only-child":{fontWeight:"normal"}},[`${n}-description`]:{marginTop:c,color:u}},[`${n}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:r}}}}},re=e=>{const{zIndexPopupBase:n}=e;return{zIndexPopup:n+60}},V=q("Popconfirm",e=>oe(e),re,{resetStyle:!1});var ce=globalThis&&globalThis.__rest||function(e,n){var s={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(s[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,t=Object.getOwnPropertySymbols(e);l<t.length;l++)n.indexOf(t[l])<0&&Object.prototype.propertyIsEnumerable.call(e,t[l])&&(s[t[l]]=e[t[l]]);return s};const L=e=>{const{prefixCls:n,okButtonProps:s,cancelButtonProps:t,title:l,description:u,cancelText:m,okText:c,okType:r="primary",icon:p=o.createElement(D,null),showCancel:v=!0,close:g,onConfirm:b,onCancel:j,onPopupClick:N}=e,{getPrefixCls:P}=o.useContext(T),[x]=A("Popconfirm",Y.Popconfirm),h=E(l),C=E(u);return o.createElement("div",{className:`${n}-inner-content`,onClick:N},o.createElement("div",{className:`${n}-message`},p&&o.createElement("span",{className:`${n}-message-icon`},p),o.createElement("div",{className:`${n}-message-text`},h&&o.createElement("div",{className:w(`${n}-title`)},h),C&&o.createElement("div",{className:`${n}-description`},C))),o.createElement("div",{className:`${n}-buttons`},v&&o.createElement(k,Object.assign({onClick:j,size:"small"},t),m||(x==null?void 0:x.cancelText)),o.createElement(G,{buttonProps:Object.assign(Object.assign({size:"small"},U(r)),s),actionFn:b,close:g,prefixCls:P("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},c||(x==null?void 0:x.okText))))},ie=e=>{const{prefixCls:n,placement:s,className:t,style:l}=e,u=ce(e,["prefixCls","placement","className","style"]),{getPrefixCls:m}=o.useContext(T),c=m("popconfirm",n),[r]=V(c);return r(o.createElement(H,{placement:s,className:w(c,t),style:l,content:o.createElement(L,Object.assign({prefixCls:c},u))}))},de=ie;var ue=globalThis&&globalThis.__rest||function(e,n){var s={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(s[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,t=Object.getOwnPropertySymbols(e);l<t.length;l++)n.indexOf(t[l])<0&&Object.prototype.propertyIsEnumerable.call(e,t[l])&&(s[t[l]]=e[t[l]]);return s};const me=o.forwardRef((e,n)=>{var s,t;const{prefixCls:l,placement:u="top",trigger:m="click",okType:c="primary",icon:r=o.createElement(D,null),children:p,overlayClassName:v,onOpenChange:g,onVisibleChange:b}=e,j=ue(e,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:N}=o.useContext(T),[P,x]=M(!1,{value:(s=e.open)!==null&&s!==void 0?s:e.visible,defaultValue:(t=e.defaultOpen)!==null&&t!==void 0?t:e.defaultVisible}),h=(i,d)=>{x(i,!0),b==null||b(i),g==null||g(i,d)},C=i=>{h(!1,i)},_=i=>{var d;return(d=e.onConfirm)===null||d===void 0?void 0:d.call(globalThis,i)},z=i=>{var d;h(!1,i),(d=e.onCancel)===null||d===void 0||d.call(globalThis,i)},B=(i,d)=>{const{disabled:X=!1}=e;X||h(i,d)},O=N("popconfirm",l),W=w(O,v),[F]=V(O);return F(o.createElement(Z,Object.assign({},J(j,["title"]),{trigger:m,placement:u,onOpenChange:B,open:P,ref:n,overlayClassName:W,content:o.createElement(L,Object.assign({okType:c,icon:r},e,{prefixCls:O,close:C,onConfirm:_,onCancel:z})),"data-popover-inject":!0}),p))}),R=me;R._InternalPanelDoNotUseOrYouWillBeFired=de;const pe=R;class f{static calculateRealPrice(n){const s=Number(n.price),t=Number(n.discount.type==="percent"?s*Number(n.discount.value)/100:Number(n.discount.value));return console.log(s,n.discount),s-t}static calculateLineTotal(n){return f.calculateRealPrice(n)*n.quantity}static calculateCartTotal(n){return n.reduce((s,t)=>{const l=f.calculateLineTotal(t);return s+l},0)}static calculateCartDiscount(n){return n.reduce((s,t)=>{const l=t.discount.type==="percent"?t.price*t.discount.value/100:t.discount.value;return s+l},0)}}const xe=({item:e,onRemove:n})=>{const{trans:s}=o.useContext(I);return a.jsx(K,{to:`/order/product/${e.productId}`,children:a.jsxs("article",{className:"flex w-full gap-4 p-4 transition-all border rounded-md lg:w-fit hover:shadow-md",children:[a.jsx("img",{className:"object-cover rounded-md",width:100,height:100,src:e.product.images[0],alt:e.product.name}),a.jsxs("div",{className:"w-full",children:[a.jsx("h3",{className:"font-semibold",children:e.product.name}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{children:y.toVND(f.calculateRealPrice(e))}),a.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["x",e.quantity]}),a.jsxs("span",{className:"font-semibold",children:[" ","= ",y.toVND(f.calculateLineTotal(e))]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(pe,{title:s({en:"Are you sure to delete this task?",vi:"Bạn có chắc chắn muốn xóa sản phẩm này không?"}),description:s({en:`Remove "${e.product.name}" from cart?`,vi:`Xóa "${e.product.name}" khỏi giỏ hàng?`}),okButtonProps:{danger:!0},okText:s({en:"Remove from cart",vi:"Xóa khỏi giỏ"}),cancelText:s({en:"Cancel",vi:"Hủy"}),onPopupClick:t=>{t.preventDefault()},onConfirm:n,children:a.jsx(k,{size:"small",shape:"round",className:"ml-auto",danger:!0,onClick:t=>t.preventDefault(),icon:a.jsx(ae,{})})})})]})]})},e.productId)},ye=()=>{const e=S.getInstance(),[n,s]=Q.useState(!1),{trans:t}=o.useContext(I),{user:l}=o.useContext(ee),[,u]=$.useMessage(),m=()=>{$.info(t({en:"This feature is not available yet",vi:"Chức năng này chưa khả dụng"}))};if(!l)return a.jsx("div",{className:"flex items-start justify-center h-screen mt-8",children:a.jsx("h1",{className:"text-xl font-bold text-center",children:t({en:"Please login to view your cart",vi:"Vui lòng đăng nhập để xem giỏ hàng của bạn"})})});const c=f.calculateCartDiscount(e);return a.jsxs("div",{children:[u,a.jsx("div",{className:"max-w-screen-xl px-2 mx-auto mb-8",children:a.jsxs(te.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},className:"grid grid-cols-8 gap-8 mt-8",children:[a.jsxs("div",{className:"p-4 pb-8 border rounded-md col-span-full lg:col-span-5 h-fit",children:[a.jsxs("h1",{className:"mt-4 mb-4 text-xl font-bold text-center font-display",children:[a.jsx(ne,{className:"mr-2 text-2xl font-bold"}),t({en:"Your Cart",vi:"Giỏ hàng của bạn"})]}),a.jsxs("div",{className:"flex flex-col flex-wrap gap-2 lg:flex-row",children:[(!e||e.length===0)&&a.jsx("div",{className:"grid w-full place-items-center",children:a.jsx(se,{description:t({en:"Your cart is empty",vi:"Giỏ hàng của bạn trống"})})}),e.map(r=>a.jsx(xe,{item:r,onRemove:()=>{S.removeItemFromCart(r,r.quantity),s(!n)}}))]})]}),a.jsxs("div",{className:"p-4 border rounded-md col-span-full lg:col-span-3 h-fit",children:[a.jsx("h2",{className:"text-2xl font-bold text-center underline ",children:t({en:"Order Summary",vi:"Tóm tắt đơn hàng"})}),a.jsxs("div",{className:"mt-2",children:[e.map((r,p)=>a.jsxs("div",{className:"flex justify-between overflow-auto",children:[a.jsxs("p",{className:"text-nowrap",children:[p+1," ",". ",r.product.name," ",a.jsxs("span",{className:"text-xs text-gray-600",children:[" ","x ",r.quantity]})]}),a.jsx("p",{className:"font-semibold",children:y.toVND(f.calculateLineTotal(r))})]},r.productId)),a.jsx(le,{}),c!=0&&a.jsxs("div",{className:"flex justify-between text-md",children:[a.jsxs("p",{children:[t({en:"Total amount reduced",vi:"Tổng tiền giảm"}),":"]}),a.jsxs("p",{className:"text-green-400 font-semibol",children:["-",y.toVND(c)]})]}),a.jsxs("div",{className:"flex items-end justify-between mt-4 text-2xl",children:[a.jsx("b",{children:t({en:"Total",vi:"Tổng tiền"})}),a.jsx("p",{className:"font-bold text-primary ",children:y.toVND(f.calculateCartTotal(e))})]}),a.jsx(k,{block:!0,type:"primary",size:"large",className:"mt-4 font-semibold tracking-widest uppercase bg-primary",onClick:m,disabled:e.length===0,children:t({en:"Checkout",vi:"Thanh toán"})})]})]})]})})]})};export{ye as default};

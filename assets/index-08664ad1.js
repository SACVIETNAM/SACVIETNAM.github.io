import{r as c,aE as g,ah as v,ax as y,L as j,j as e,m as w,aR as E,ay as D,N as _}from"./index-51183d7f.js";import{A as H,u as L}from"./AxiosJWTConfig-54097723.js";import{b as V}from"./productService-521eee96.js";import{A as U}from"./authService-57dbc50f.js";import{F as q,a as k,T as G}from"./index-8632c68b.js";import{R as N,D as K}from"./index-7edd0816.js";import{B as I}from"./button-9b5ae836.js";import{C as A}from"./comingsoon-square-df519825.js";import{I as C}from"./index-9465b3b4.js";import{I as Q}from"./index-544acc2f.js";import{F as J}from"./Formatter-fb77eadb.js";import{D as $}from"./index-81634cab.js";import{P as W}from"./Pagination-67e77464.js";import{m as p}from"./index-677a26b7.js";import"./CloseCircleFilled-aa26d74b.js";import"./index-f064d780.js";import"./compact-item-c1d3c96e.js";import"./pickAttrs-4856a254.js";import"./index.esm-77f1b63d.js";import"./EyeOutlined-5f22b75d.js";import"./LeftOutlined-9a65a1da.js";import"./RightOutlined-d1bd1910.js";import"./index-065e50bb.js";var Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM512 533c-85.5 0-155.6 67.3-160 151.6a8 8 0 008 8.4h48.1c4.2 0 7.8-3.2 8.1-7.4C420 636.1 461.5 597 512 597s92.1 39.1 95.8 88.6c.3 4.2 3.9 7.4 8.1 7.4H664a8 8 0 008-8.4C667.6 600.3 597.5 533 512 533z"}}]},name:"frown",theme:"outlined"};const X=Y;var Z=function(a,t){return c.createElement(g,v({},a,{ref:t,icon:X}))},ee=c.forwardRef(Z);const z=ee;var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 565H360c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"meh",theme:"outlined"};const te=se;var ae=function(a,t){return c.createElement(g,v({},a,{ref:t,icon:te}))},ne=c.forwardRef(ae);const ce=ne;var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};const ie=re;var oe=function(a,t){return c.createElement(g,v({},a,{ref:t,icon:ie}))},le=c.forwardRef(oe);const de=le;var me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"};const ue=me;var xe=function(a,t){return c.createElement(g,v({},a,{ref:t,icon:ue}))},he=c.forwardRef(xe);const fe=he;var ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 533h-48.1c-4.2 0-7.8 3.2-8.1 7.4C604 589.9 562.5 629 512 629s-92.1-39.1-95.8-88.6c-.3-4.2-3.9-7.4-8.1-7.4H360a8 8 0 00-8 8.4c4.4 84.3 74.5 151.6 160 151.6s155.6-67.3 160-151.6a8 8 0 00-8-8.4z"}}]},name:"smile",theme:"outlined"};const ve=ge;var pe=function(a,t){return c.createElement(g,v({},a,{ref:t,icon:ve}))},je=c.forwardRef(pe);const O=je,P=U.getAxiosInstance(),be=H.getJWTInstance(),Ce=async(s,a=5,t=1)=>(await P.get(`/feedbacks/products/${s}?limit=${a}&page=${t}`)).data.feedbacks,we=async s=>(await P.get(`/feedbacks/products/${s}/size`)).data.size,ye=async s=>{try{const a=await be.post("/feedbacks/",s);return console.log("ADDFEDDBACK REUSLT",a),!0}catch{return!1}},Ne={1:e.jsx(z,{}),2:e.jsx(z,{}),3:e.jsx(ce,{}),4:e.jsx(O,{}),5:e.jsx(O,{})},Fe=({onSubmit:s})=>{const{user:a}=c.useContext(y),{trans:t}=c.useContext(j),[r,i]=c.useState({rate:5,content:""}),n=u=>{i(h=>({...h,rate:u}))},l=u=>{i(h=>({...h,content:u}))},f=()=>{s(r),i({rate:5,content:""})},d=(()=>{switch(r.rate){case 1:return"#FF0000";case 2:return"#FFA500";case 3:return"#FFD700";case 4:case 5:return"#4CAF50"}})(),m=(()=>{switch(r.rate){case 1:return t({en:"Very bad",vi:"Rất tệ"});case 2:return t({en:"Bad",vi:"Tệ"});case 3:return t({en:"Normal",vi:"Bình thường"});case 4:return t({en:"Good",vi:"Tốt"});case 5:return t({en:"Very good",vi:"Rất tốt"});default:return""}})();return e.jsx("div",{className:"order-1 mx-auto w-full md:order-2 col-span-12 max-w-[500px] max-h-[300px] h-fit p-4  mb-8 md:col-span-4 border rounded-md",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:a?a.name:t({en:"Your review",vi:"Cảm nhận của bạn"})}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(N,{allowClear:!1,defaultValue:r.rate,onChange:n,character:({index:u=0})=>Ne[u+1],style:{color:d}}),e.jsx("span",{className:"text-sm",children:m})]}),e.jsxs(q,{onFinish:f,className:"w-full",children:[e.jsx(k,{name:"feedback",rules:[{required:!0,message:t({en:"Please share your feeling a little bit...",vi:"Hãy chia sẻ một chút cảm xúc của bạn..."})}],children:e.jsx(G,{disabled:!a,showCount:!0,className:"w-full mb-4",autoSize:{minRows:2,maxRows:5},rows:2,placeholder:t({en:"Please text your feedback",vi:"Nhập bình luận của bạn..."}),maxLength:200,value:r.content,onChange:u=>l(u.target.value)})}),e.jsx(k,{children:e.jsx(I,{icon:e.jsx(fe,{}),disabled:!a,block:!0,htmlType:"submit",type:"dashed",children:t({en:"Send feedback",vi:"Gửi phản hồi"})})})]}),!a&&e.jsx("i",{className:"text-xs text-left text-red-400",children:t({en:"You must be logged in to be able to post feedback",vi:"Bạn phải đăng nhập để có thể gửi phản hồi"})})]})})},Se=({product:s,onAddItem:a})=>{const[t,r]=c.useState(0),{trans:i}=c.useContext(j),{user:n}=c.useContext(y),[l,f]=c.useState(1);return e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative grid grid-cols-1 gap-8 md:grid-cols-2",children:[e.jsxs("div",{className:"inline-grid grid-cols-8 gap-2 ",children:[e.jsx("div",{className:"flex flex-col w-full col-span-1 gap-4",children:s==null?void 0:s.images.map((d,m)=>e.jsx(w.img,{whileHover:{scale:1.1,rotate:5},src:d,className:`w-full object-cover ${t===m?"opacity-70":""}`,onMouseEnter:()=>r(m)},m))}),e.jsxs("div",{className:"grid col-span-7 place-items-center",children:[e.jsx(C,{src:s==null?void 0:s.images[t],className:"object-cover w-full max-h-[400px] ",placeholder:e.jsx(C,{preview:!1,src:A,width:200})}),s.images.length==0&&e.jsx(C,{preview:!1,className:"object-cover w-full max-h-[400px] ",src:A})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:s.name}),e.jsx(K,{discount:s.discount,price:s.price}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("span",{className:"font-semibold",children:[i({en:"Description",vi:"Mô tả"}),":",e.jsx("br",{})]}),e.jsx("ul",{className:"pl-8 list-disc",children:s.description.split(`
`).map((d,m)=>d.length!==0&&e.jsxs("li",{children:[d,e.jsx("br",{})]},m))})]}),e.jsxs("div",{className:"mt-10",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"mr-2 text-sm font-semibold",children:[i({en:"Quantity",vi:"Số lượng"}),":"]}),e.jsx(Q,{size:"middle",min:1,max:100,defaultValue:l,onChange:d=>f(d),className:"mb-2"})]}),!n&&e.jsx("span",{className:"text-sm italic text-red-400",children:i({en:"Please log in to place an order!",vi:"Hãy đăng nhập để có thể đặt mua!"})}),e.jsx(I,{size:"large",block:!0,type:"primary",className:" bg-primary",icon:e.jsx(de,{}),disabled:!n,onClick:()=>a(l),children:i({en:"Add to cart",vi:"Thêm vào giỏ hàng"})})]})]})]},s._id)},ke=({feedback:s})=>e.jsxs("div",{className:"grid w-full grid-cols-1 p-4 border rounded-md md:grid-cols-4",children:[e.jsxs("div",{className:"flex flex-col md:col-span-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"mr-4 text-sm font-semibold",children:s.nameUser}),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:J.toDateTime(s.createdAt)})]}),e.jsx(N,{value:s.rate,className:"text-sm",disabled:!0})]}),e.jsxs("div",{className:"flex gap-2 mt-1 w-fit md:col-span-3 md:mt-0",children:[e.jsx($,{type:"vertical",className:"hidden h-full md:block"}),e.jsx("p",{className:"text-xs break-all w-fit",children:s.content})]})]},s._id),Ae=({product:s,feedbacks:a,totalFeedback:t,pageSize:r,changePage:i})=>{const{trans:n}=c.useContext(j);return console.log("render FeedbackBlock",t,r),e.jsxs("div",{className:"order-2 col-span-12 p-4 mb-4 border rounded-md md:order-1 md:col-span-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-center ",children:n({en:"Review from user",vi:"Đánh giá từ người dùng"})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(N,{value:s.rate,disabled:!0}),e.jsxs("span",{className:"text-xs",children:["(",s.quantityRate,")"]})]}),e.jsx($,{}),e.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[s.quantityRate==0&&e.jsxs("p",{className:"text-sm text-center text-gray-400",children:["(",e.jsx("i",{children:n({en:"There have been no responses from the user yet.",vi:"Chưa có phản hồi nào của người dùng."})}),")"]}),a&&a.map(l=>e.jsx(ke,{feedback:l},l._id)),t>r&&e.jsx("div",{className:"p-2 pb-8 mx-auto w-fit",children:e.jsx(W,{className:"p-2 bg-white border rounded-md ",total:t,defaultCurrent:1,defaultPageSize:r,onChange:l=>i(l)})})]})]})},R=10,Xe=()=>{const{id:s}=E(),[,a]=p.useMessage(),{trans:t}=c.useContext(j),{user:r}=c.useContext(y),{addItemToCart:i}=c.useContext(D),{data:n,isLoading:l,refetch:f}=L({queryKey:["products","/id"],queryFn:()=>V(s),select:o=>o}),[d,m]=c.useState(0),[u,h]=c.useState([]),[F,S]=c.useState(1),b=c.useRef(null),M=o=>{S(o),b.current&&b.current.scrollIntoView({behavior:"smooth",block:"start"})},B=async o=>{if(n&&r)try{await ye({content:o.content,product_id:n._id,rate:o.rate,user_id:r._id,nameUser:r.name})?(p.success(t({en:"Feedback successfully!",vi:"Đánh giá thành công!"})),f(),S(1)):p.info(t({en:"Feedback failed!",vi:"Đánh giá thất bại!"}))}catch(x){console.log(x)}},T=o=>{n&&(i(n,o),p.success(t({en:`Add ${o} item "${n.name}" to cart!`,vi:`Đã thêm ${o} sản phẩm "${n.name}" vào giỏ hàng`})))};return c.useEffect(()=>{n&&(async()=>{try{const x=await Ce(n==null?void 0:n._id,R,F);console.log("GET FEEDBACKS"),h(x)}catch{h([])}})()},[n,F]),c.useEffect(()=>{n&&(async()=>{try{const x=await we(n==null?void 0:n._id);m(x)}catch{m(0)}})()},[n]),n?e.jsxs("div",{className:"relative ",children:[a,e.jsxs("div",{className:"max-w-screen-xl min-h-screen px-2 py-4 mx-auto mt-8",children:[e.jsx(Se,{product:n,onAddItem:T}),e.jsxs(w.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.3},className:"grid grid-cols-12 gap-2 mt-4 ",ref:b,children:[e.jsx(Ae,{product:n,feedbacks:u,totalFeedback:d,pageSize:R,changePage:M}),e.jsx(Fe,{onSubmit:B})]})]})]}):e.jsx(_,{})};export{Xe as default};

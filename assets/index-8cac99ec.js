import{r as c,a2 as g,a0 as v,av as B,aw as w,L as b,j as e,ax as T,ay as F,az as E,aA as O,m as C,aB as D,aC as p,aD as _}from"./index-a11c9a5b.js";import{u as H}from"./useQuery-bb942738.js";import{b as L}from"./productService-690f8da2.js";import{N as V}from"./index-174f02ca.js";import{A as U}from"./AxiosJWTConfig-9c6b1903.js";import{R as y,D as q}from"./index-03174c2f.js";import{I as S}from"./index-fa1a32f8.js";import{I as G}from"./index-7059d305.js";import{F as K}from"./Formatter-fb77eadb.js";import{D as I}from"./index-94cb970d.js";import{P as Q}from"./Pagination-d7dedbc6.js";import"./index-47226e9a.js";import"./LeftOutlined-d5f2f0d2.js";import"./useForceUpdate-48271d46.js";import"./index-44d99f72.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM512 533c-85.5 0-155.6 67.3-160 151.6a8 8 0 008 8.4h48.1c4.2 0 7.8-3.2 8.1-7.4C420 636.1 461.5 597 512 597s92.1 39.1 95.8 88.6c.3 4.2 3.9 7.4 8.1 7.4H664a8 8 0 008-8.4C667.6 600.3 597.5 533 512 533z"}}]},name:"frown",theme:"outlined"};const W=J;var Y=function(n,t){return c.createElement(g,v({},n,{ref:t,icon:W}))},X=c.forwardRef(Y);const k=X;var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 565H360c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"meh",theme:"outlined"};const ee=Z;var se=function(n,t){return c.createElement(g,v({},n,{ref:t,icon:ee}))},te=c.forwardRef(se);const ae=te;var ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};const ce=ne;var re=function(n,t){return c.createElement(g,v({},n,{ref:t,icon:ce}))},ie=c.forwardRef(re);const le=ie;var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"};const de=oe;var me=function(n,t){return c.createElement(g,v({},n,{ref:t,icon:de}))},ue=c.forwardRef(me);const xe=ue;var he={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM664 533h-48.1c-4.2 0-7.8 3.2-8.1 7.4C604 589.9 562.5 629 512 629s-92.1-39.1-95.8-88.6c-.3-4.2-3.9-7.4-8.1-7.4H360a8 8 0 00-8 8.4c4.4 84.3 74.5 151.6 160 151.6s155.6-67.3 160-151.6a8 8 0 00-8-8.4z"}}]},name:"smile",theme:"outlined"};const fe=he;var ge=function(n,t){return c.createElement(g,v({},n,{ref:t,icon:fe}))},ve=c.forwardRef(ge);const A=ve,R=B.getAxiosInstance(),pe=U.getJWTInstance(),be=async(s,n=5,t=1)=>(await R.get(`/feedbacks/products/${s}?limit=${n}&page=${t}`)).data.feedbacks,je=async s=>(await R.get(`/feedbacks/products/${s}/size`)).data.size,Ce=async s=>{try{const n=await pe.post("/feedbacks/",s);return console.log("ADDFEDDBACK REUSLT",n),!0}catch{return!1}},we={1:e.jsx(k,{}),2:e.jsx(k,{}),3:e.jsx(ae,{}),4:e.jsx(A,{}),5:e.jsx(A,{})},ye=({onSubmit:s})=>{const{user:n}=c.useContext(w),{trans:t}=c.useContext(b),[r,a]=c.useState({rate:5,content:""}),d=o=>{a(h=>({...h,rate:o}))},l=o=>{a(h=>({...h,content:o}))},f=()=>{s(r),a({rate:5,content:""})},m=(()=>{switch(r.rate){case 1:return"#FF0000";case 2:return"#FFA500";case 3:return"#FFD700";case 4:case 5:return"#4CAF50"}})(),x=(()=>{switch(r.rate){case 1:return t({en:"Very bad",vi:"Rất tệ"});case 2:return t({en:"Bad",vi:"Tệ"});case 3:return t({en:"Normal",vi:"Bình thường"});case 4:return t({en:"Good",vi:"Tốt"});case 5:return t({en:"Very good",vi:"Rất tốt"});default:return""}})();return e.jsx("div",{className:"order-1 mx-auto w-full md:order-2 col-span-12 max-w-[500px] max-h-[300px] h-fit p-4  mb-8 md:col-span-4 border rounded-md",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:n?n.name:t({en:"Your review",vi:"Cảm nhận của bạn"})}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(y,{allowClear:!1,defaultValue:r.rate,onChange:d,character:({index:o=0})=>we[o+1],style:{color:m}}),e.jsx("span",{className:"text-sm",children:x})]}),e.jsxs(T,{onFinish:f,className:"w-full",children:[e.jsx(F,{name:"feedback",rules:[{required:!0,message:t({en:"Please share your feeling a little bit...",vi:"Hãy chia sẻ một chút cảm xúc của bạn..."})}],children:e.jsx(E,{disabled:!n,showCount:!0,className:"w-full mb-4",autoSize:{minRows:2,maxRows:5},rows:2,placeholder:t({en:"Please text your feedback",vi:"Nhập bình luận của bạn..."}),maxLength:200,value:r.content,onChange:o=>l(o.target.value)})}),e.jsx(F,{children:e.jsx(O,{icon:e.jsx(xe,{}),disabled:!n,block:!0,htmlType:"submit",type:"dashed",children:t({en:"Send feedback",vi:"Gửi phản hồi"})})})]}),!n&&e.jsx("i",{className:"text-xs text-left text-red-400",children:t({en:"You must be logged in to be able to post feedback",vi:"Bạn phải đăng nhập để có thể gửi phản hồi"})})]})})},Ne=({product:s,onAddItem:n})=>{const[t,r]=c.useState(0),{trans:a}=c.useContext(b),{user:d}=c.useContext(w),[l,f]=c.useState(1);return e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative grid grid-cols-1 gap-8 md:grid-cols-2",children:[e.jsxs("div",{className:"inline-grid grid-cols-8 gap-2 ",children:[e.jsx("div",{className:"flex flex-col w-full col-span-1 gap-4",children:s==null?void 0:s.images.map((m,x)=>e.jsx(C.img,{whileHover:{scale:1.1,rotate:5},src:m,className:`w-full object-cover ${t===x?"opacity-70":""}`,onMouseEnter:()=>r(x)},x))}),e.jsx("div",{className:"grid col-span-7 place-items-center",children:e.jsx(S,{src:s==null?void 0:s.images[t],className:"object-cover w-full max-h-[400px] ",placeholder:e.jsx(S,{preview:!1,src:"https://placehold.co/600x400",width:200})})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:s.name}),e.jsx(q,{discount:s.discount,price:s.price}),e.jsxs("p",{className:"mt-4",children:[e.jsxs("span",{className:"font-semibold",children:[a({en:"Description",vi:"Mô tả"}),":",e.jsx("br",{})]}),s.description]}),e.jsxs("div",{className:"mt-10",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"mr-2 text-sm font-semibold",children:[a({en:"Quantity",vi:"Số lượng"}),":"]}),e.jsx(G,{size:"middle",min:1,max:100,defaultValue:l,onChange:m=>f(m),className:"mb-2"})]}),!d&&e.jsx("span",{className:"text-sm italic text-red-400",children:a({en:"Please log in to place an order!",vi:"Hãy đăng nhập để có thể đặt mua!"})}),e.jsx(O,{size:"large",block:!0,type:"primary",className:" bg-primary",icon:e.jsx(le,{}),disabled:!d,onClick:()=>n(l),children:a({en:"Add to cart",vi:"Thêm vào giỏ hàng"})})]})]})]},s._id)},Fe=({feedback:s})=>e.jsxs("div",{className:"grid w-full grid-cols-1 p-4 border rounded-md md:grid-cols-4",children:[e.jsxs("div",{className:"flex flex-col md:col-span-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"mr-4 text-sm font-semibold",children:s.nameUser}),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:K.toDateTime(s.createdAt)})]}),e.jsx(y,{value:s.rate,className:"text-sm",disabled:!0})]}),e.jsxs("div",{className:"flex gap-2 mt-1 w-fit md:col-span-3 md:mt-0",children:[e.jsx(I,{type:"vertical",className:"hidden h-full md:block"}),e.jsx("p",{className:"text-xs break-all w-fit",children:s.content})]})]},s._id),Se=({product:s,feedbacks:n,totalFeedback:t,pageSize:r,changePage:a})=>{const{trans:d}=c.useContext(b);return console.log("render FeedbackBlock",t,r),e.jsxs("div",{className:"order-2 col-span-12 p-4 mb-4 border rounded-md md:order-1 md:col-span-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-center ",children:d({en:"Review from user",vi:"Đánh giá từ người dùng"})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(y,{value:s.rate,disabled:!0}),e.jsxs("span",{className:"text-xs",children:["(",s.quantityRate,")"]})]}),e.jsx(I,{}),e.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[s.quantityRate==0&&e.jsxs("p",{className:"text-sm text-center text-gray-400",children:["(",e.jsx("i",{children:d({en:"There have been no responses from the user yet.",vi:"Chưa có phản hồi nào của người dùng."})}),")"]}),n&&n.map(l=>e.jsx(Fe,{feedback:l},l._id)),t>r&&e.jsx("div",{className:"p-2 pb-8 mx-auto w-fit",children:e.jsx(Q,{className:"p-2 bg-white border rounded-md ",total:t,defaultCurrent:1,defaultPageSize:r,onChange:l=>a(l)})})]})]})},z=10,Le=()=>{const{id:s}=D(),[,n]=p.useMessage(),{trans:t}=c.useContext(b),{user:r}=c.useContext(w),{data:a,isLoading:d,refetch:l}=H({queryKey:["products","/id"],queryFn:()=>L(s),select:i=>i}),[f,m]=c.useState(0),[x,o]=c.useState([]),[h,N]=c.useState(1),j=c.useRef(null),$=i=>{N(i),j.current&&j.current.scrollIntoView({behavior:"smooth",block:"start"})},P=async i=>{if(a&&r)try{await Ce({content:i.content,product_id:a._id,rate:i.rate,user_id:r._id,nameUser:r.name})?(p.success(t({en:"Feedback successfully!",vi:"Đánh giá thành công!"})),l(),N(1)):p.info(t({en:"Feedback failed!",vi:"Đánh giá thất bại!"}))}catch(u){console.log(u)}},M=i=>{a&&(_.addItemToCart(a,i),p.success(t({en:`Add ${i} item "${a.name}" to cart!`,vi:`Đã thêm ${i} sản phẩm "${a.name}" vào giỏ hàng`})))};return c.useEffect(()=>{a&&(async()=>{try{const u=await be(a==null?void 0:a._id,z,h);console.log("GET FEEDBACKS"),o(u)}catch{o([])}})()},[a,h]),c.useEffect(()=>{a&&(async()=>{try{const u=await je(a==null?void 0:a._id);m(u)}catch{m(0)}})()},[a]),a?e.jsxs("div",{className:"relative ",children:[n,e.jsxs("div",{className:"max-w-screen-xl min-h-screen px-2 py-4 mx-auto mt-8",children:[e.jsx(Ne,{product:a,onAddItem:M}),e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.3},className:"grid grid-cols-12 gap-2 mt-4 ",ref:j,children:[e.jsx(Se,{product:a,feedbacks:x,totalFeedback:f,pageSize:z,changePage:$}),e.jsx(ye,{onSubmit:P})]})]})]}):e.jsx(V,{})};export{Le as default};
